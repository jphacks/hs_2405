{"ast":null,"code":"// chatService.js\nimport { collection, addDoc, query, where, getDocs } from 'firebase/firestore';\nimport { db } from './firebase';\nexport async function getOrCreateChat(userId, matchedUserId) {\n  // 既存チャットがあるかチェック\n  const chatQuery = query(collection(db, 'Chats'), where('user1', 'in', [userId, matchedUserId]), where('user2', 'in', [userId, matchedUserId]));\n  const chatSnapshot = await getDocs(chatQuery);\n  if (!chatSnapshot.empty) {\n    return chatSnapshot.docs[0].id; // 既存のチャットIDを返す\n  }\n\n  // 新しいチャットを作成\n  const newChatRef = await addDoc(collection(db, 'Chats'), {\n    user1: userId,\n    user2: matchedUserId,\n    messages: [] // 空のメッセージリストで初期化\n  });\n  return newChatRef.id;\n}","map":{"version":3,"names":["collection","addDoc","query","where","getDocs","db","getOrCreateChat","userId","matchedUserId","chatQuery","chatSnapshot","empty","docs","id","newChatRef","user1","user2","messages"],"sources":["/Users/shuga/hs_2405/src/chatService.js"],"sourcesContent":["// chatService.js\nimport { collection, addDoc, query, where, getDocs } from 'firebase/firestore';\nimport { db } from './firebase';\n\nexport async function getOrCreateChat(userId, matchedUserId) {\n  // 既存チャットがあるかチェック\n  const chatQuery = query(\n    collection(db, 'Chats'),\n    where('user1', 'in', [userId, matchedUserId]),\n    where('user2', 'in', [userId, matchedUserId])\n  );\n\n  const chatSnapshot = await getDocs(chatQuery);\n  if (!chatSnapshot.empty) {\n    return chatSnapshot.docs[0].id;  // 既存のチャットIDを返す\n  }\n\n  // 新しいチャットを作成\n  const newChatRef = await addDoc(collection(db, 'Chats'), {\n    user1: userId,\n    user2: matchedUserId,\n    messages: []  // 空のメッセージリストで初期化\n  });\n  return newChatRef.id;\n}"],"mappings":"AAAA;AACA,SAASA,UAAU,EAAEC,MAAM,EAAEC,KAAK,EAAEC,KAAK,EAAEC,OAAO,QAAQ,oBAAoB;AAC9E,SAASC,EAAE,QAAQ,YAAY;AAE/B,OAAO,eAAeC,eAAeA,CAACC,MAAM,EAAEC,aAAa,EAAE;EAC3D;EACA,MAAMC,SAAS,GAAGP,KAAK,CACrBF,UAAU,CAACK,EAAE,EAAE,OAAO,CAAC,EACvBF,KAAK,CAAC,OAAO,EAAE,IAAI,EAAE,CAACI,MAAM,EAAEC,aAAa,CAAC,CAAC,EAC7CL,KAAK,CAAC,OAAO,EAAE,IAAI,EAAE,CAACI,MAAM,EAAEC,aAAa,CAAC,CAC9C,CAAC;EAED,MAAME,YAAY,GAAG,MAAMN,OAAO,CAACK,SAAS,CAAC;EAC7C,IAAI,CAACC,YAAY,CAACC,KAAK,EAAE;IACvB,OAAOD,YAAY,CAACE,IAAI,CAAC,CAAC,CAAC,CAACC,EAAE,CAAC,CAAE;EACnC;;EAEA;EACA,MAAMC,UAAU,GAAG,MAAMb,MAAM,CAACD,UAAU,CAACK,EAAE,EAAE,OAAO,CAAC,EAAE;IACvDU,KAAK,EAAER,MAAM;IACbS,KAAK,EAAER,aAAa;IACpBS,QAAQ,EAAE,EAAE,CAAE;EAChB,CAAC,CAAC;EACF,OAAOH,UAAU,CAACD,EAAE;AACtB","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}